{{> schedule-tabs route='changeShifts'}}

<div class="container mt-5">
  <div class="card shadow">
    <div class="card-header bg-primary text-white">
      <h3 class="mb-0">Change Shift Request</h3>
    </div>
    <div class="card-body">
      <form action="/changeShifts" method="POST">
        <div class="mb-3">
          <label class="form-label">Name:</label>
          <input type="text" class="form-control" value="{{user.name}}" readonly>
        </div> 

         <div class="mb-3">
          <label class="form-label">Email:</label>
          <input type="text" class="form-control" value="{{user.email}}" readonly>
        </div> 
        
        <div class="mb-3">
          <label class="form-label">Current Shift Start Date:</label>
          <input id="currentStartDate" type="date" name="currentStartDate" class="form-control" required>
        </div> 

        <div class="mb-3">
          <label class="form-label">Current Shift End Date:</label>
          <input id="currentEndDate" type="date" name="currentEndDate" class="form-control" required>
        </div> 

        <div class="mb-3">
          <label class="form-label">New Shift Start Date:</label>
          <input id="newStartDate" type="date" name="newStartDate" class="form-control" required>
        </div> 

        <div class="mb-3">
          <label class="form-label">New Shift End Date:</label>
          <input id="newEndDate" type="date" name="newEndDate" class="form-control" required>
        </div>

        <div class="mb-3">
          <label class="form-label">Select Colleague to Swap With:</label>
          <select id="colleagueSelect" name="colleagueId" class="form-control" required>
            <option value="" disabled selected>Select a colleague</option>
            {{#each users}}
              <option value="{{this.id}}">{{this.name}} ({{this.email}})</option>
            {{/each}}
          </select>
        </div>

        <div class="d-flex justify-content-between mt-4">
          <button class="btn btn-primary" type="submit" onclick="return confirmSubmission()">Submit Request</button>
          <a class="btn btn-outline-secondary" href="javascript:history.back()">Back</a>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  const newStartDateInput = document.getElementById('newStartDate');
  const newEndDateInput = document.getElementById('newEndDate');
  const currentStartDateInput = document.getElementById('currentStartDate');
  const currentEndDateInput = document.getElementById('currentEndDate');

  newStartDateInput.addEventListener('change', function() {
    const newStartDate = this.value;
    newEndDateInput.min = newStartDate;
  });

  newEndDateInput.addEventListener('change', function() {
    const newEndDate = this.value;
    newStartDateInput.max = newEndDate;
  });

  currentStartDateInput.addEventListener('change', function() {
    const currentStartDate = this.value;
    currentEndDateInput.min = currentStartDate;
  });

  currentEndDateInput.addEventListener('change', function() {
    const currentEndDate = this.value;
    currentStartDateInput.max = currentEndDate;
  });

  function confirmSubmission() {
    return confirm('Are you sure you want to submit this shift change request?');
  }
</script>
