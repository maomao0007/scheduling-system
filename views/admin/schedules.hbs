{{> admin-tabs route="schedules" }}

<div>admin schedules</div>
    
    <form action="/admin/schedules" method:"POST">
    <div class="container mt-5">
        <h2 class="text-center mb-4" id="currentMonth"></h2>
        <div class="row mb-3">
            <div class="col">
                <button id="prevMonth" class="btn btn-primary">&lt; Previous Month</button>
            </div>
            <div class="col text-end">
                <button id="nextMonth" class="btn btn-primary">Next Month &gt;</button>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead class="table-light">
                    <tr>
                        <th>Monday</th>
                        <th>Tuesday</th>
                        <th>Wednesday</th>
                        <th>Thursday</th>
                        <th>Friday</th>
                        <th>Saturday</th>
                        <th>Sunday</th>
                    </tr>
                </thead>
                <tbody id="calendar-body">
                </tbody>
            </table>
        </div>
    </div>
    </form>
    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
    let currentDate = new Date();

    function createShiftSelect(shift, date) {
        const select = document.createElement('select');
        select.className = 'shift-select form-select form-select-sm';
        select.name = `shift_${date.getTime()}_${shift}`;
        select.innerHTML = `
            <option value="">Select ${shift}</option>
            <option value="admin">Admin</option>
            <option value="user1">User 1</option>
            <option value="user2">User 2</option>
            <option value="user3">User 3</option>
            <option value="user4">User 4</option>
            <option value="user5">User 5</option>
        `;
        return select;
    }

    function generateCalendar(date) {
        const year = date.getFullYear();
        const month = date.getMonth();
        
        const monthNames = ["January", "February", "March", "April", "May", "June",
                            "July", "August", "September", "October", "November", "December"];
        
        document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year}`;

        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);

        let dayOfWeek = firstDay.getDay() || 7; // Adjust Sunday to be 7 instead of 0
        dayOfWeek--; // Adjust to start from Monday

        const calendarBody = document.getElementById('calendar-body');
        calendarBody.innerHTML = '';

        let date1 = new Date(firstDay);
        date1.setDate(date1.getDate() - dayOfWeek);

        for (let i = 0; i < 6; i++) {
            const row = document.createElement('tr');
            for (let j = 0; j < 7; j++) {
                const cell = document.createElement('td');
                cell.className = 'calendar-day';
                
                if (date1.getMonth() !== month) {
                    cell.classList.add('other-month');
                }
                
                if (date1.toDateString() === new Date().toDateString()) {
                    cell.classList.add('table-primary', 'fw-bold');
                }
                
                cell.innerHTML = `<div>${date1.getDate()}</div>`;
                cell.appendChild(createShiftSelect('Morning', date1));
                cell.appendChild(createShiftSelect('Middle', date1));
                cell.appendChild(createShiftSelect('Night', date1));

                row.appendChild(cell);

                date1.setDate(date1.getDate() + 1);
            }
            calendarBody.appendChild(row);
            if (date1 > lastDay) break;
        }
    }

    document.getElementById('prevMonth').addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        generateCalendar(currentDate);
    });

    document.getElementById('nextMonth').addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        generateCalendar(currentDate);
    });

    generateCalendar(currentDate);
    </script>



<script id="shift-select-template" type="text/x-handlebars-template">
  <select class="shift-select form-select form-select-sm" name="shift_{{dateTime}}_{{shift}}">
    <option value="">Select {{shift}}</option>
    <option value="admin">Admin</option>
    {{#each users}}
      <option>{{this.name}}</option>
    {{/each}}
  </select>
</script>